{% extends "journal/base.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/journal.css') }}">
    <style>
        .day {
            max-width: unset;
        }
    </style>
{% endblock %}

{% block body %}
    {{ super() }}

    <form method="post">
        <div class="pt-3 px-5 d-flex align-items-center">
            <div class="mr-3">
                <p class="lead">Предмет</p>
                <select class="d-block custom-select class-select form-control mt-0" name="subject" id="subject_select">
                </select>
            </div>
            <div class="mr-3">
                <p class="lead">Класс</p>
                <select class="custom-select class-select form-control mt-0" id="grade_number_select"
                        name="grade-number">
                    {% if selected %}
                        <option selected
                                value="{{ selected['grade_number_select'] }}">{{ selected['grade_number_select'] }}</option>
                    {% endif %}
                </select>
                <select class="custom-select class-select form-control mt-0" id="grade_letter_select"
                        name="grade-letter">
                    {% if selected %}
                        <option selected
                                value="{{ selected['grade_letter_select'] }}">{{ selected['grade_letter_select'] }}</option>
                    {% endif %}
                </select>
            </div>
            <div class="mr-3">
                <p class="lead">Четверть</p>
                <select class="d-block custom-select class-select form-control mt-0" name="quarter" id="quarter_select">
                    {% if selected %}
                        <option selected value="{{ selected['quarter'] }}">{{ selected['quarter'] }}</option>
                        {% for q in range(1, 5) %}
                            {% if q != selected['quarter'] %}
                                <option value="{{ q }}">{{ q }}</option>
                            {% endif %}
                        {% endfor %}
                    {% else %}
                        {% for q in range(1, 5) %}
                            <option value="{{ q }}">{{ q }}</option>
                        {% endfor %}
                    {% endif %}
                </select>
            </div>
            {% if date_range %}
                <div class="mr-3">
                    <p class="lead">Классный руководитель</p>
                    <input class="form-control" value="{{ homeroom_teacher }}" readonly>
                </div>
            {% endif %}
            <div>
                <button class="btn btn-primary" id="load" type="submit">Загрузить</button>
            </div>
        </div>
    </form>

    {% if date_range %}

        <div class="mt-3 w-100 px-3" style="overflow-y: auto">
            <div class="day d-flex flex-column">
                <h3>Оценки {{ selected['grade_number_select'] }} "{{ selected['grade_letter_select'] }}" класса</h3>
                <table class="table table-hover table-dark flex-shrink-0">
                    <tr>
                        <th></th>
                        {% for d in date_range %}
                            <th class="text-muted px-1">{{ (d.day | string).zfill(2) }}.{{ (d.month | string).zfill(2) }}</th>
                        {% endfor %}
                        <th class="px-0 text-muted">Средняя</th>
                    </tr>
                    {% for student in students %}
                        <tr>
                            <td>{{ student[1] }}</td>
                            {% for d2 in date_range %}
                                <td class="mark_"
                                    onclick="window.location =
                                            'http://localhost:8080/grading/{{ selected.subject_id }}/{{ selected.grade_id }}/{{ d2.strftime('%d-%m-%Y') }}'">
                                    5
                                </td>
                            {% endfor %}
                            <td class="mark_">4.5</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>

    {% endif %}

    <script src="{{ url_for('static', filename='js/journal.js') }}"></script>

{% endblock %}
